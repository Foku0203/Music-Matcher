{% extends 'matcher/base.html' %}
{% load static %}

{% block content %}
<style>
  @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');
  nav.navbar { display: none !important; }

  body { font-family:'Poppins', sans-serif; background:#0f1219; margin:0; color:#fff; overflow-x:hidden; }
  .admin-container { display:flex; min-height:100vh; }

  .sidebar{
    width:250px; background:linear-gradient(180deg,#3a1c71,#1e2235 60%,#0f1219 100%);
    padding:30px 20px; position:fixed; height:100vh; z-index:100; display:flex; flex-direction:column;
  }
  .brand{ font-size:1.5rem; font-weight:700; margin-bottom:50px; color:#fff; }
  .menu-list{ display:flex; flex-direction:column; gap:15px; }
  .menu-item{
    display:flex; align-items:center; gap:15px; padding:12px 20px; color:#a0a0a0; text-decoration:none;
    font-size:0.95rem; transition:.3s; border-radius:12px;
  }
  .menu-item:hover,.menu-item.active{ background:rgba(255,255,255,.1); color:#fff; }
  .menu-item.active{ position:relative; background:linear-gradient(90deg, rgba(255,255,255,.15), transparent); }
  .menu-item.active::before{ content:''; position:absolute; left:0; height:100%; width:4px; background:#3498db; border-radius:0 5px 5px 0; }

  .logout-btn{ margin-top:auto; display:flex; align-items:center; gap:10px; color:#7f8c8d; text-decoration:none; font-size:.9rem; transition:.3s; }
  .logout-btn:hover{ color:#e74c3c; }

  .main-content{ flex:1; margin-left:250px; padding:30px 40px; background:#121622; }

  .action-bar{ display:flex; justify-content:space-between; align-items:center; margin-bottom:20px; }
  .page-title{ font-size:1.6rem; font-weight:600; }
  .page-sub{ color:#888; font-size:.9rem; margin-top:6px; }

  .filter-container{
    display:flex; gap:12px; margin-bottom:20px; background:#1b202e; padding:15px; border-radius:12px; align-items:center;
  }
  .search-input{ background:#121622; border:1px solid #2e3446; padding:10px 15px; border-radius:8px; color:#fff; outline:none; width:320px; }
  .btn-search{ background:#3498db; color:#fff; border:none; padding:10px 18px; border-radius:8px; cursor:pointer; font-weight:500; }

  .database-card{ background:#1b202e; border-radius:15px; padding:25px; box-shadow:0 4px 20px rgba(0,0,0,.2); }
  table{ width:100%; border-collapse:collapse; }
  th{ text-align:left; padding:15px; color:#888; font-weight:500; border-bottom:1px solid #2e3446; font-size:.9rem; }
  td{ padding:15px; border-bottom:1px solid #232936; vertical-align:middle; color:#ddd; font-size:.95rem; }
  tr:hover td{ background:rgba(255,255,255,.02); }

  .song-info{ display:flex; align-items:center; gap:15px; }
  .cover-wrapper{ width:50px; height:50px; border-radius:8px; overflow:hidden; background:#333; flex-shrink:0; display:flex; align-items:center; justify-content:center; }
  .cover-img{ width:100%; height:100%; object-fit:cover; }
  .song-text h4{ margin:0; font-size:1rem; color:#fff; }
  .song-text p{ margin:3px 0 0 0; font-size:.85rem; color:#aaa; }

  .btn-back{
    background:#121622; border:1px solid #2e3446; color:#fff; padding:10px 14px; border-radius:10px; cursor:pointer; text-decoration:none;
  }
  .btn-back:hover{ border-color:#3b4a66; }
</style>

{% with current=request.resolver_match.url_name %}
<div class="admin-container">
  <div class="sidebar">
    <div class="brand">Admin</div>
    <div class="menu-list">
      <a href="{% url 'matcher:admin_panel' %}" class="menu-item {% if current == 'admin_panel' %}active{% endif %}">
        <i class="fas fa-home"></i> Dashboard
      </a>
      <a href="{% url 'matcher:user_management' %}" class="menu-item {% if current == 'user_management' %}active{% endif %}">
        <i class="fas fa-user"></i> User Management
      </a>
      <a href="{% url 'matcher:behavior_analysis' %}" class="menu-item {% if current == 'behavior_analysis' %}active{% endif %}">
        <i class="fas fa-chart-line"></i> Behavior Analysis
      </a>
      <a href="{% url 'matcher:song_database' %}" class="menu-item {% if current == 'song_database' %}active{% endif %}">
        <i class="fas fa-database"></i> Song Database
      </a>
      <a href="{% url 'matcher:category_management' %}" class="menu-item active">
        <i class="fas fa-th-large"></i> Category Management
      </a>
      <a href="{% url 'matcher:model_management' %}" class="menu-item {% if current == 'model_management' %}active{% endif %}">
        <i class="fas fa-cube"></i> Model
      </a>
    </div>

    <a href="{% url 'matcher:logout' %}" class="logout-btn">
      <i class="fas fa-sign-out-alt"></i> Logout
    </a>
  </div>

  <div class="main-content">
    <div class="action-bar">
      <div>
        <div class="page-title">Songs in: {{ category.name }}</div>
        <div class="page-sub">Type: {{ category.type }}</div>
      </div>
      <a class="btn-back" href="{% url 'matcher:category_management' %}">Back to Categories</a>
    </div>

    <form method="get" class="filter-container">
      <input class="search-input" type="text" name="q" placeholder="Search title / artist..." value="{{ query|default:'' }}">
      <button class="btn-search" type="submit">Search</button>
    </form>

    <div class="database-card">
      <table>
        <thead>
          <tr>
            <th width="80">ID</th>
            <th>Track Info</th>
            <th>Created</th>
          </tr>
        </thead>
        <tbody>
          {% for song in songs %}
          <tr>
            <td style="color:#666;">{{ song.song_id }}</td>
            <td>
              <div class="song-info">
                <div class="cover-wrapper">
                  {% if song.album and song.album.cover_url %}
                    <img src="{{ song.album.cover_url }}" class="cover-img" alt="cover">
                  {% else %}
                    <i class="fas fa-music" style="color:#777;"></i>
                  {% endif %}
                </div>
                <div class="song-text">
                  <h4>{{ song.title }}</h4>
                  <p>{{ song.artist.name }}</p>
                </div>
              </div>
            </td>
            <td style="color:#aaa;">{{ song.created_at|date:"d M, Y" }}</td>
          </tr>
          {% empty %}
          <tr>
            <td colspan="3" style="text-align:center; padding:40px; color:#777;">
              No songs found for this category.
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>
{% endwith %}
{% endblock %}
